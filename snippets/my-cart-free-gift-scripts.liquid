{% if product.handle == 'therapiedecken' %}

  {% comment %} Promo variant id - we need the id of one of the variants {% endcomment %}
  {% assign promoVariant = settings.gift_product_variant_id  %}
  {% assign promoSubtotal = settings.gift_product_min_spend  %}

  {% if promoVariant != blank and promoSubtotal != blank %}
    <script type="module">
        import { cartRequestAdd, cartRequestChange, subscribeToCartStateUpdate } from '{{ "liquid-ajax-cart-v1.10.0.js" | asset_url }}';


        subscribeToCartStateUpdate( state => {
        
        	let items = state.cart.items;
            const totalItemsInCart = state.cart.item_count;
            
            const giftTriggerItem = items.filter(item => {
            	return item.handle === 'therapiedecken';
            });
            
            console.log("giftTriggerItem: ");
            console.log(giftTriggerItem);


            if ( giftTriggerItem.length >= 1 ) {
                cartRequestAdd({ 
                  items: [
                    {
                      id: 34447711174795,
                      quantity: 1,
                      properties: {
                      	"_autoadded": "Yes" 
                        }
                    }
                  ]  
                });
            }

         });
    </script>
  {% endif %}


{% endif %}